{
  "version": 3,
  "sources": ["../../src/playground-plugin/index.js"],
  "sourcesContent": ["import { Hono } from 'hono';\nimport { serveStatic } from '@hono/node-server/serve-static';\nimport nunjucks from 'nunjucks';\nimport fs from 'fs';\nimport path from 'path';\nimport yaml from 'js-yaml';\nimport MarkdownIt from 'markdown-it';\nimport markdownItAnchor from 'markdown-it-anchor';\nimport hljs from 'highlight.js/lib/common';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport default function playgroundServ(root) {\n  const app = new Hono();\n  let manifest;\n\n  nunjucks.configure(path.join(__dirname, 'templates'), {\n    autoescape: true,\n    watch: false,\n    noCache: true,\n  });\n\n  const demoHtml = nunjucks.render('./pages/demo.njk', { manifest });\n  const prerenderHtml = nunjucks.render('./pages/prerender.njk', { manifest });\n  const landingHtml = nunjucks.render('./pages/landing.njk', { manifest });\n  const docsHtml = nunjucks.render('./pages/docs.njk', {\n    text: generateDocsText(root),\n    manifest,\n  });\n\n  app.use('/css/*', serveStatic({ root: path.join(__dirname, 'templates') }));\n  app.use('/js/*', serveStatic({ root: path.join(__dirname, 'templates') }));\n  app.use(\n    '/assets/*',\n    serveStatic({ root: path.join(__dirname, 'templates') }),\n  );\n  app.use(\n    '/favicon.png',\n    serveStatic({ path: path.join(__dirname, 'templates/favicon.png') }),\n  );\n\n  app.get('/prerender', async (c) => c.html(prerenderHtml));\n  app.get('/demo', (c) => c.html(demoHtml));\n  app.get('/documentation', (c) => c.html(docsHtml));\n  app.get('/', (c) => c.html(landingHtml));\n\n  return {\n    name: 'vite:playground-serv',\n    async buildStart() {\n      const manifestPath = path.resolve(process.cwd(), 'src/manifest.yaml');\n      const content = fs.readFileSync(manifestPath, 'utf8');\n      manifest = yaml.load(content, 'utf8');\n    },\n    configureServer(server) {\n      server.middlewares.use(async (req, res, next) => {\n        const request = new Request(`http://localhost${req.url}`, {\n          method: req.method,\n          headers: req.headers,\n        });\n        const response = await app.fetch(request);\n        if (!response.ok) {\n          next();\n          return;\n        }\n        res.statusCode = response.status;\n        response.headers.forEach((value, key) => {\n          res.setHeader(key, value);\n        });\n        const body = await response.arrayBuffer();\n        res.end(Buffer.from(body));\n      });\n    },\n  };\n}\n\nfunction generateDocsText(root) {\n  const md = MarkdownIt({\n    highlight: function (str, lang) {\n      if (lang && hljs.getLanguage(lang)) {\n        try {\n          return (\n            '<pre><code class=\"hljs\">' +\n            hljs.highlight(str, { language: lang, ignoreIllegals: true })\n              .value +\n            '</code></pre>'\n          );\n        } catch {\n          void 0;\n        }\n      }\n      return (\n        '<pre><code class=\"hljs\">' + md.utils.escapeHtml(str) + '</code></pre>'\n      );\n    },\n  });\n  md.use(markdownItAnchor);\n  const mdPath = path.resolve(`${root}/openmfe/index.md`);\n  const mdRaw = fs.readFileSync(mdPath, 'utf8');\n  const text = md.render(mdRaw);\n  return text;\n}\n"],
  "mappings": "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",
  "names": ["Hono", "serveStatic", "nunjucks", "fs", "path", "yaml", "MarkdownIt", "markdownItAnchor", "hljs", "fileURLToPath", "__filename", "__dirname", "playgroundServ", "root", "app", "manifest", "demoHtml", "prerenderHtml", "landingHtml", "docsHtml", "generateDocsText", "c", "manifestPath", "content", "server", "req", "res", "next", "request", "response", "value", "key", "body", "md", "str", "lang", "mdPath", "mdRaw"]
}
